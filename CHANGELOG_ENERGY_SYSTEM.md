# 元气值机制及哈特形象系统更新日志

## 版本: v2.0 - 6级哈特系统

### 🎯 更新概述

本次更新实现了完整的6级元气值机制和哈特心脏形象系统，基于MovAIQ的UI设计规范。

### ✨ 新增功能

#### 1. 6级哈特等级系统

- **Lv.0 病变濒危** (0分)
  - 深灰黑色 (#2C2C2C)
  - 不透明度: 60%
  - 心跳间隔: 10秒
  - 装饰: 厚重乌云 + 闪电 + 绷带
  - 裂纹: 5条
  - 消息: "危险！需要立即休息！"

- **Lv.1 垂头丧气** (1-19分)
  - 灰暗色 (#4A2424)
  - 不透明度: 70%
  - 心跳间隔: 5秒
  - 装饰: 小乌云下雨
  - 裂纹: 3条
  - 消息: "快撑不住了..."

- **Lv.2 元气不足** (20-39分)
  - 暗紫红色 (#8B1A1A)
  - 不透明度: 85%
  - 心跳间隔: 2.5秒
  - 装饰: 无
  - 裂纹: 1条
  - 消息: "有点累了，减速调整一下"

- **Lv.3 基础平稳** (40-69分)
  - 暗红色 (#C7233A)
  - 不透明度: 100%
  - 心跳间隔: 1.8秒
  - 光晕: 微弱
  - 消息: "保持节奏，继续前进"

- **Lv.4 活力充沛** (70-89分)
  - 健康红色 (#FF3B30)
  - 不透明度: 100%
  - 心跳间隔: 1.2秒
  - 光晕: 粉色中等强度
  - 装饰: 偶尔光点
  - 消息: "状态很棒！保持下去！"

- **Lv.5 元气爆棚** (90-100分)
  - 鲜红色 (#FF2D55)
  - 不透明度: 100%
  - 心跳间隔: 0.8秒
  - 光晕: 金色强光晕
  - 装饰: 音符环绕
  - 消息: "元气爆棚！势不可挡！"

#### 2. 动态心跳动画

每个等级都有独特的心跳动画：
- 双节拍心跳效果（咚-咚节奏）
- 根据元气值调整心跳频率和幅度
- 不同的缩放系数体现状态差异

#### 3. 视觉反馈增强

- **颜色渐变**: 6种不同的颜色方案
- **不透明度**: 低等级状态更透明
- **阴影效果**: 高等级有更强的发光效果
- **光晕动画**: Lv.3及以上有脉动光晕
- **装饰元素**:
  - 乌云、闪电、雨滴（低等级）
  - 光点、音符（高等级）

#### 4. UI组件更新

- 元气值进度条支持6个等级的颜色变化
- 元气值数值显示支持6个等级的文字颜色
- 心脏图标支持动态缩放和不透明度
- 启动屏也完整支持6级系统

### 🔧 技术实现

#### 修改的文件

1. **public/energy-system.js**
   - 重构heartStates数组，支持6个等级
   - 新增level、name、opacity等属性
   - 优化getDetailedStatus()方法
   - 新增getHartLevel()辅助方法

2. **public/styles.css**
   - 添加6个等级的心跳动画关键帧
   - 更新.heart-icon[data-state]样式
   - 新增6个等级的元气值颜色方案
   - 优化视觉效果和阴影

3. **public/app.js**
   - 增强updateEnergyUI()函数
   - 增强updateLaunchEnergy()函数
   - 添加不透明度和等级名称显示

### 📊 等级判定规则

```javascript
function getHartLevel() {
  const energy = this.getEnergy();
  if (energy >= 90) return 5;  // 元气爆棚
  if (energy >= 70) return 4;  // 活力充沛
  if (energy >= 40) return 3;  // 基础平稳
  if (energy >= 20) return 2;  // 元气不足
  if (energy >= 1) return 1;   // 垂头丧气
  return 0;                    // 病变濒危
}
```

### 🎨 设计原则

- **情感化设计**: 哈特的状态变化激发用户的保护欲和责任感
- **视觉反馈**: 每个等级都有明显的视觉差异
- **动画流畅**: 使用CSS动画确保60fps
- **渐进增强**: 从低等级到高等级逐步增加视觉元素

### 🚀 使用示例

```javascript
// 获取当前元气值状态
const status = energySystem.getDetailedStatus();
console.log(`当前等级: Lv.${status.level} ${status.name}`);
console.log(`元气值: ${status.energy}%`);
console.log(`激励消息: ${status.message}`);

// 获取哈特等级
const level = energySystem.getHartLevel(); // 0-5
```

### 🔄 兼容性

- 完全向后兼容原有的5级系统
- 新增Lv.0等级表示极度危险状态
- 所有现有功能保持不变

### 📝 待优化项

- [ ] 添加装饰元素的实际渲染（乌云、闪电、音符等）
- [ ] 实现裂纹效果的SVG路径
- [ ] 添加粒子效果系统
- [ ] 实现面部表情系统
- [ ] 添加浮动动画（高等级）

### 👨‍💻 开发者

基于MovAIQ设计规范实现
参考文档: MovAIQ_Design_Brief_Optimized.md

### 📅 更新时间

2025-10-30
